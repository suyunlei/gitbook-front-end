# ðŸ¤¡ æµè§ˆå™¨ç¼“å­˜

## å¼ºåˆ¶ç¼“å­˜

### Expires

HTTP1.0æ—¶æœŸçš„äº§ç‰©ï¼Œæ˜¯HTTP`å“åº”å¤´`ä¸­çš„å­—æ®µã€‚å…¶è§„å®š`ç¼“å­˜çš„è¿‡æœŸæ—¶é—´`ã€‚ Expiresçš„æŽ§åˆ¶åŽŸç†æ˜¯`ä½¿ç”¨å®¢æˆ·ç«¯çš„æ—¶é—´å’ŒæœåŠ¡å™¨ç«¯è¿”å›žçš„æ—¶é—´è¿›è¡Œå¯¹æ¯”`ï¼Œå¦‚æžœå®¢æˆ·ç«¯æ—¶é—´å’ŒæœåŠ¡å™¨ç«¯æ—¶é—´æ—¶åŒºä¸åŒï¼Œåˆ™ä¼šå‡ºçŽ°ç¼“å­˜å¤±æ•ˆã€‚

### Cache-Control

HTTP1.1åŽï¼ŒCathe-Controlå–ä»£äº†Expiresã€‚æ˜¯HTTP`å“åº”å¤´`ä¸­çš„å­—æ®µã€‚ä¸»è¦çš„å–å€¼ä¸ºï¼š

* `public`: æ‰€æœ‰å†…å®¹éƒ½å°†è¢«ç¼“å­˜ï¼Œå®¢æˆ·ç«¯å’Œä»£ç†æœåŠ¡å™¨éƒ½å¯ä»¥ç¼“å­˜
* `private`: æ‰€æœ‰å†…å®¹éƒ½å°†è¢«ç¼“å­˜ï¼Œä½†åªæœ‰å®¢æˆ·ç«¯å¯ä»¥ç¼“å­˜ **é»˜è®¤å€¼**
* `no-cache`: å®¢æˆ·ç«¯ç¼“å­˜å†…å®¹ï¼Œä½†æ˜¯å¦ä½¿ç”¨ç¼“å­˜éœ€è¦ç»è¿‡åå•†ç¼“å­˜æ¥éªŒè¯å†³å®šã€‚
* `no-store`ï¼šæ‰€æœ‰å†…å®¹éƒ½ä¸ä¼šè¢«ç¼“å­˜ã€‚
* `max-age=xxx`ï¼šç¼“å­˜å†…å®¹å°†åœ¨xxxç§’åŽå¤±æ•ˆã€‚

åŒæ—¶è¦æ³¨æ„ï¼ŒCache-Controlçš„ä¼˜å…ˆçº§è¦æ¯”Expiresé«˜ã€‚

Cacheåˆåˆ†ä¸ºï¼š

* from memory cacheï¼šå†…å­˜ç¼“å­˜ å†…å­˜ç¼“å­˜çš„ç‰¹ç‚¹æ˜¯å…¶å…·æœ‰å¿«é€Ÿè¯»å–å’Œæ—¶æ•ˆæ€§çš„ç‰¹ç‚¹ã€‚ å­˜æ”¾åœ¨**è¿›ç¨‹**ä¸­
* from disc cacheï¼š ç¡¬ç›˜ç¼“å­˜ ç¡¬ç›˜ç¼“å­˜åˆ™å­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šã€‚è¯»å–æ—¶éœ€è¦å¯¹ç¡¬ç›˜è¿›è¡ŒI/Oæ“ä½œï¼Œé€Ÿåº¦æ…¢ã€‚

åœ¨æµè§ˆå™¨ä¸­ï¼ŒJSæ–‡ä»¶å’Œå›¾ç‰‡ç­‰ä¼šå­˜å‚¨åˆ°å†…å­˜ç¼“å­˜ä¸­ã€‚ CSSæ–‡ä»¶ä¼šå­˜å‚¨åˆ°ç¡¬ç›˜ç¼“å­˜ä¸­ã€‚

## åå•†ç¼“å­˜

åå•†ç¼“å­˜å°±æ˜¯**å¼ºåˆ¶ç¼“å­˜å¤±æ•ˆ**ä»¥åŽï¼Œæµè§ˆå™¨å¸¦ç€**ç¼“å­˜æ ‡è¯†**(å…¶å®žå°±æ˜¯`Last-Modified`å­—æ®µ)ï¼Œå†æ¬¡å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚ç”±æœåŠ¡å™¨æ ¹æ®ç¼“å­˜æ ‡è¯†å†³å®šæ˜¯å¦ä½¿ç”¨ç¼“å­˜çš„è¿‡ç¨‹ã€‚

åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š

1. è¯¥èµ„æºæ— æ›´æ–°ï¼Œè¿”å›ž`304`ï¼Œæµè§ˆå™¨ç»§ç»­ä»Žç¼“å­˜ä¸­å–ã€‚ ![cache-304](images/cache-304.png)
2. è¯¥èµ„æºæ›´æ–°äº†ï¼Œè¿”å›ž`200`å’Œæ–°çš„ç»“æžœã€‚æµè§ˆå™¨å°†æ–°çš„ç»“æžœå­˜å…¥ç¼“å­˜ä¸­ã€‚ ![cache-200](images/cache-200.png)

### Last-Modified

æ˜¯HTTP`å“åº”å¤´`çš„ä¸€ä¸ªå­—æ®µï¼Œæè¿°çš„æ˜¯è¯¥èµ„æºæ–‡ä»¶åœ¨æœåŠ¡å™¨æœ€åŽè¢«ä¿®æ”¹çš„æ—¶é—´ã€‚

### If-Modified-since

æ˜¯HTTP`è¯·æ±‚å¤´`çš„ä¸€ä¸ªå­—æ®µï¼Œæè¿°çš„æ˜¯å®¢æˆ·ç«¯å†æ¬¡å¯¹æœåŠ¡å™¨å‘èµ·è¯·æ±‚æ—¶ï¼Œæºå¸¦çš„ä¸Šæ¬¡æœåŠ¡å™¨è¿”å›žçš„`Last-Modified`å€¼ã€‚é€šè¿‡æ­¤å­—æ®µå‘Šè¯‰æœåŠ¡å™¨è¯¥èµ„æºä¸Šæ¬¡è¯·æ±‚è¿”å›žçš„æœ€åŽè¢«ä¿®æ”¹çš„æ—¶é—´ã€‚

* å¦‚æžœæœåŠ¡å™¨å­˜å‚¨çš„æœ€åŽä¿®æ”¹æ—¶é—´**å¤§äºŽ**`if-Modified-since`çš„å€¼ï¼Œå³ä¿®æ”¹äº†ï¼Œè¿”å›ž`200`å’Œ`æ–°å†…å®¹`ã€‚
* å¦‚æžœæœåŠ¡å™¨å­˜å‚¨çš„æœ€åŽä¿®æ”¹æ—¶é—´ä¸Ž`if-Modified-since`çš„å€¼**ä¸€è‡´**ï¼Œå³æ²¡æœ‰ä¿®æ”¹ï¼Œè¿”å›ž`304`.

### E-tag

æ˜¯HTTP`å“åº”å¤´`ä¸­çš„å­—æ®µï¼Œæ˜¯æœåŠ¡å™¨ç”Ÿæˆçš„å½“å‰èµ„æºæ–‡ä»¶çš„ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ã€‚

E-tag if-none-matchçš„æœºåˆ¶ä¼˜å…ˆçº§**é«˜äºŽ**Last-modifedå’Œif-modified-since

### if-none-match

æ˜¯HTTP`è¯·æ±‚å¤´`ä¸­çš„å­—æ®µï¼Œè®°å½•çš„æ˜¯ä¸Šä¸€æ¬¡è®¿é—®æ—¶å€™æœåŠ¡å™¨è¿”å›žçš„E-tagå€¼ã€‚ æœåŠ¡å™¨ä¼šå°†`if-none-match`çš„å€¼å’ŒæœåŠ¡å™¨ä¸Šå­˜å‚¨çš„`E-tag`å€¼è¿›è¡Œå¯¹æ¯”ï¼š

* if-none-matchå’ŒæœåŠ¡å™¨çŽ°åœ¨çš„e-tag**ä¸åŒ**ï¼Œè¿”å›ž`200`å’Œæ–°çš„å†…å®¹
* if-none-matchå’ŒæœåŠ¡å™¨çŽ°åœ¨çš„e-tag**ç›¸åŒ**ï¼Œè¿”å›ž`304`.

## æ€»ç»“

1. å¼ºåˆ¶ç¼“å­˜**ä¼˜å…ˆ**äºŽåå•†ç¼“å­˜ã€‚
   * å¼ºåˆ¶ç¼“å­˜ç”Ÿæ•ˆåˆ™ç›´æŽ¥ä½¿ç”¨ç¼“å­˜
   * å¼ºåˆ¶ç¼“å­˜ä¸ç”Ÿæ•ˆåˆ™è¿›è¡Œåå•†ç¼“å­˜
     * Last-modifedå’Œif-modifed-since
     * E-tagå’Œif-none-match
2. ä¼˜å…ˆçº§
   * `catch-Control` > `Expires`
   * `e-tag/if-none-match` > `last-modified/if-modified-since`
